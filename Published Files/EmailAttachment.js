//Open Email App
var EmailAttachIconData = "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d95c7cb438ed5db4485d2e0447fd0e04485d6e74482cfe24482cfe24481d0e24481d0e34480d0e44480d0e44482cfe54483cee5447ecbd54481ced74484d1da2285d2db0000000000000000000000009d71d0e4ff55e1fcff4de4ffff49e7ffff4fecffff54e7ffff54e7ffff52e8ffff51e8ffff50e9ffff50e9ffff56e7faff56e7faff54e5ffff54e6ffff54e6fff054e6ff0000000000000000000000009560bfd3eb4ad6f1ff50e8ffff4eebffff47e4ffff51e4fbff51e4fbff4fe4fcff4ee5fcff4de5fcff4de5fcff53e3f6ff53e3f6ff5ef0ffff55e6fffc47d9f4d43ecfeb000000000000000000000000aa4598bef131b0e0c837ccf5ff45e6ffff50f2ffff4debfdff4feafdff50e9ffff51e8ffff51e8ffff52e7ffff54e8fcff56e6fcff52d8fff842c8ffff2eb4eeff22a7e2000000000000000000000000aa4a9dc3ff34b2e3ff1db2dbd023c4e5eb3cdefaff4ceafcff4ee9fcff4fe8feff50e7ffff50e7ffff51e6ffff53e7fbff55e5fbff3ac0fbff2cb2ecff1ca2ddff189ed8000000000000000000000000ab6594ceff4990d8ff3b9ddcff2aa1d4f220a3ccc842cbeaff57e0ffff63e7ffff5dddffff5bd8ffff5cd9ffff4ccbffff33b5ebff1ca9eaff1ba8e9ff19a7e7ff18a6e60000000000000000b74d658fef4473adff2970b8ff0a6cabff0e85b8ff25a7d1ff21aac9f02ab3d2ff45c9f2ff61e1ffff60deffff44c1faff28a7ddff1c9dd3ff1aa7e8ff19a6e7ff17a5e5ff16a4e40000000000000000595768b7cf445fbbff4973d8ff3072cfff2a84d4ff33a5e9ff26a7e0ff189cd3ff1b9fdcff2cb0f1ff2eaef7ff1e9ee8ff199ce6ff25a9f2ff259fe5ff249ee5ff229ce3ff219be21b5e6ca4bb56649cbb3c4d9cea425db9ff305bbfff2567c4ff207acaff2698dcff1d9ed7ff1ca0d8ff189dd9ff1396d8ff1595deff1c9ce7ff1fa2ebff1ea2ebff249ee4ff239de4ff229ce3ff219be210505aab875a64b6883f59b0da4b77cfff326fcaff2170c9ff1877cdff2293e2ff1894deff1ca5e9ff19a8e9ff0e9ddeff0f9cdfff1da4e9ff22a0e9ff1594ddff1d9de4ff1d9de4ff1d9de4ff1d9de4a45660b2aa4954a5aa5771c8e52854acff2461bcff1a6ac2ff1f7ed3ff35a6f6ff27a4edff1aa3e7ff109fe0ff0c9bdcff0c98dbff1198ddff1a99e2ff1e9ce5ff1899dfff1999e0ff1a9ae1ff1b9be2936164a0994e528d99386394df3275a5ff217cadff147fb5ff127fbfff2094dcff239ce7ff1798e1ff0e9cdfff13a1e3ff149ee0ff1392d8ff1f88d7ff248dddff1091dbff1292ddff1394dfff1596e00000000000000000000000009b5da1d1ff3792c3ff2f99d0ff2894d5ff2fa2eaff1e97e2ff199be3ff109ee1ff0d9bddff0f98daff1595daff238cdbff2089daff0b8cd6ff0c8dd7ff0f90daf21192dc0000000000000000000000000c5d7d8c426997a9525590a77640849f764f96b8764991b7764990b9764b8db8764c8bb7764c88b4764d86b1764d85af764c85ad763b7ea2763b7ea2763b7ea23f3b7ea2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"

var EmailAttachIcon = {count: 0,width: 20,height: 20, read: function(nBytes){return EmailAttachIconData.slice(this.count, this.count += nBytes);}};

var EmailAttach = app.trustedFunction(function(){
    // emailing the pdf
    this.mailDoc();
});

app.addToolButton({
    cName: "EmailAttachment",
    cLabel: "Email",
    oIcon: EmailAttachIcon,
    cEnable: "event.rc = (app.doc != null);",
    cExec: "EmailAttach()",
});